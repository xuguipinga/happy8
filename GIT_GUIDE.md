# Git 常用命令详解手册

**更新提示**：Git 在 2.23 版本（2019年发布）引入了两个新命令 `git switch` 和 `git restore`，专门用来替代 `git checkout` 容易让人混淆的功能。现在的最佳实践是使用这些新命令。

---

## 1. 初次配置 (Configuration)

在使用 Git 之前，你需要告诉 Git 你是谁。

*   **配置用户名**
    ```bash
    git config --global user.name "你的名字"
    ```
    *解释：设置提交代码时显示的用户名。`--global` 表示对你会做的所有项目生效。*

*   **配置邮箱**
    ```bash
    git config --global user.email "你的邮箱@example.com"
    ```
    *解释：设置提交代码时显示的邮箱。*

*   **查看当前配置**
    ```bash
    git config --list
    ```
    *解释：列出所有 Git 配置信息，检查是否设置正确。*

---

## 2. 获取项目 (Getting Started)

*   **克隆远程仓库 (Clone)**
    ```bash
    git clone <仓库地址>
    # 例如：git clone https://github.com/xxxxx.git
    ```
    *解释：将远程服务器上的项目完整下载到本地。这是开始新项目的第一步。*

*   **初始化新仓库 (Init)**
    ```bash
    git init
    ```
    *解释：将当前文件夹变成一个 Git 仓库（如果你不是从远程克隆，而是从零开始写代码）。*

---

## 3. 日常开发流程 (Daily Workflow)

这是你每天最常用的命令组合。

### 3.1 查看状态
*   **查看文件状态**
    ```bash
    git status
    ```
    *解释：**最重要的命令！** 随时用它来看看哪些文件被修改了（红色），哪些已经准备好提交了（绿色）。*

### 3.2 提交代码
*   **添加文件到暂存区 (Add)**
    ```bash
    git add .
    ```
    *解释：将**所有**修改过的文件不仅仅是保存，而是放入“待提交”的名单中（暂存区）。*
    *   `git add <文件名>`：只添加特定文件。

*   **提交更改 (Commit)**
    ```bash
    git commit -m "这里写清楚你做了什么修改"
    ```
    *解释：将暂存区的内容正式保存到版本历史中。`-m` 后面必须跟上引号括起来的说明信息，方便以后回顾。*

### 3.3 同步代码
*   **拉取最新代码 (Pull)**
    ```bash
    git pull
    ```
    *解释：从远程仓库下载最新的代码并合并到你的本地。**建议每天开工前先运行一次**，避免和别人冲突。*

*   **推送代码 (Push)**
    ```bash
    git push
    ```
    *解释：将你本地提交的新代码上传到远程仓库。只有 Push 之后，别人才能看到你的修改。*

---

## 4. 分支管理 (Branching) - 推荐使用新命令

> **为什么 `git checkout` 容易混淆？**
> 老版本的 Git 中，`git checkout` 既可以用来切换分支，又可以用来撤销文件修改。
> 为了解决这个问题，新版本 Git 把它拆分成了两个更直观命令：**`git switch` (切换分支)** 和 **`git restore` (恢复文件)**。
>
> **注意**：`git checkout` 仍然完全可用，并没有被删除。如果你习惯用它，或是看旧教程，依然没问题。只是为了概念清晰，推荐新手使用新命令。

*   **查看分支**
    ```bash
    git branch
    ```
    *解释：列出所有本地分支，当前所在的分支前面会有 `*` 号。*

*   **创建并切换分支**
    *   **推荐 (新)**：
        ```bash
        git switch -c <新分支名>
        ```
    *   *老版本习惯：`git checkout -b <新分支名>`*
    *   *解释：创建一个新分支，并立即切换过去。常用于开发新功能。*

*   **切换分支**
    *   **推荐 (新)**：
        ```bash
        git switch <分支名>
        ```
    *   *老版本习惯：`git checkout <分支名>`*
    *   *解释：切换到指定的分支。*

*   **合并分支 (Merge)**
    ```bash
    git merge <其他分支名>
    ```
    *解释：将“其他分支”的代码合并到“当前分支”。比如在 `main` 分支执行 `git merge dev`，就是把 `dev` 的修改合并进 `main`。*

---

## 5. 后悔药 (Undo & Reset) - 推荐使用新命令

*   **撤销工作区的修改 (Restore)**
    *   **推荐 (新)**：
        ```bash
        git restore <文件名>
        ```
    *   *老版本习惯：`git checkout -- <文件名>`*
    *   *解释：**危险！** 丢弃你对该文件做的所有修改，恢复到上一次提交的状态。*

*   **撤销 `git add` (Unstage)**
    *   **推荐 (新)**：
        ```bash
        git restore --staged <文件名>
        ```
    *   *老版本习惯：`git reset HEAD <文件名>`*
    *   *解释：如果你不小心 `add` 了不该提交的文件，用这个命令把它移出暂存区（文件修改内容保留）。*

*   **查看提交历史**
    ```bash
    git log
    ```
    *解释：查看详细的提交记录（谁、什么时候、改了什么）。按 `q` 退出。*
    *   `git log --oneline`：查看简洁的一行版历史。

---

## 6. 常见问题速查

1.  **冲突 (Conflict) 怎么办？**
    *   现象：`git pull` 或 `git merge` 时提示 "CONFLICT"。
    *   解决：
        1.  打开冲突的文件。
        2.  搜索 `<<<<<<<`，你会看到你的代码和别人的代码被分隔开。
        3.  手动修改，保留想要的代码，删除 `<<<<<<<`, `=======`, `>>>>>>>` 标记。
        4.  保存文件。
        5.  `git add .`
        6.  `git commit -m "解决冲突"`

2.  **`git push` 失败？**
    *   如果不允许推送，通常是因为远程有你没有的更新。
    *   先 `git pull`，解决可能出现的冲突，然后再 `git push`。

3.  **命令卡住了，输不了字？**
    *   现象：运行 `git log` 或 `git config --list` 后，屏幕下方显示 `End` 或 `:`，无法输入新命令。
    *   原因：这是为了方便阅读长内容，进入了“阅读模式”。
    *   解决：**按一下键盘上的 `q` 键** (Quit) 即可退出。
